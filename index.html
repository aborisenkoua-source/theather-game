<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>–¢–∞–π–Ω–∞ —Å—Ç–∞—Ä–æ–≥–æ —Ç–µ–∞—Ç—Ä–∞</title>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { 
      display: block; 
      pointer-events: auto !important; 
    }
  </style>
</head>
<body>
<div id="game-container"></div>
<script>
const config = {
  type: Phaser.AUTO,
  width: 1280,
  height: 720,
  backgroundColor: '#000000',
  scale: {
    mode: Phaser.Scale.FIT,
    autoCenter: Phaser.Scale.CENTER_BOTH,
    parent: 'game-container'
  },
  scene: {
    preload: preload,
    create: create
  }
};

let activeDialog = null;

const game = new Phaser.Game(config);

function preload() {
  this.load.image('background', 'theater.jpg');
  
  // –°–æ–∑–¥–∞—ë–º 1x1 –ø—Ä–æ–∑—Ä–∞—á–Ω—É—é —Ç–µ–∫—Å—Ç—É—Ä—É –¥–ª—è –Ω–µ–≤–∏–¥–∏–º—ã—Ö —Å–ø—Ä–∞–π—Ç–æ–≤
  let transparentPixel = this.textures.createCanvas('pixel', 1, 1);
  let ctx = transparentPixel.getContext('2d');
  ctx.fillStyle = '#000000';
  ctx.fillRect(0, 0, 1, 1);
  transparentPixel.refresh();
}

  
function create() {
  activeDialog = null;

  // –§–æ–Ω ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –∑–∞–¥–Ω–∏–π –ø–ª–∞–Ω
  this.add.image(640, 360, 'background') // —Ü–µ–Ω—Ç—Ä = (1280/2, 720/2)
    .setDisplaySize(1280, 720)
    .setDepth(-1);

  // –£–ª–∏–∫–∏: [x, y, radius, —Ç–µ–∫—Å—Ç]
  const clues = [
    [640, 500, 30, 'üé≠ –ú–∞—Å–∫–∞...'],      // —Ü–µ–Ω—Ç—Ä —Å—Ü–µ–Ω—ã –ø–æ X
    [900, 550, 25, '‚òï –ß–∞—à–∫–∞...'],      // —Å–ø—Ä–∞–≤–∞
    [400, 550, 25, 'üìú –ó–∞–ø–∏—Å–∫–∞...'],    // —Å–ª–µ–≤–∞
    [1100, 400, 20, 'üé´ –ë–∏–ª–µ—Ç...'],     // —É –∫—É–ª–∏—Å
    [200, 400, 20, 'üîë –ö–ª—é—á...']       // —É –∑–∞–¥–Ω–∏–∫–∞
  ];

  // –°–æ–∑–¥–∞—ë–º –ù–ï–í–ò–î–ò–ú–´–ï —Å–ø—Ä–∞–π—Ç—ã –≤–º–µ—Å—Ç–æ –∑–æ–Ω
  clues.forEach(clue => {
    // –°–æ–∑–¥–∞—ë–º —Å–ø—Ä–∞–π—Ç —Å "–ø—É—Å—Ç–æ–π" —Ç–µ–∫—Å—Ç—É—Ä–æ–π
    let sprite = this.add.sprite(clue[0], clue[1], 'pixel');
    
    // –ó–∞–¥–∞—ë–º —Ä–∞–∑–º–µ—Ä (–¥–∏–∞–º–µ—Ç—Ä = 2 * —Ä–∞–¥–∏—É—Å)
    sprite.displayWidth = clue[2] * 2;
    sprite.displayHeight = clue[2] * 2;
    
    // –î–µ–ª–∞–µ–º –Ω–µ–≤–∏–¥–∏–º—ã–º, –Ω–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º
    //sprite.alpha = 0; // –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π
    sprite.setInteractive({ cursor: 'pointer' });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
    sprite.on('pointerdown', () => {
      console.log('–ö–ª–∏–∫ –ø–æ —É–ª–∏–∫–µ:', clue[3]);
      showText(this, clue[3]);
    });
    
    // üî¥ –í–†–ï–ú–ï–ù–ù–û: –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ ‚Äî —É–±–µ—Ä–∏ alpha=0 –∏ –¥–æ–±–∞–≤—å —Ü–≤–µ—Ç
    // sprite.clearTint();
    sprite.setTint(0xff0000);
    sprite.alpha = 0.3;
  });

  // –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
  const chars = [
    { x: 200, name: '–õ—é–¥–º–∏–ª–∞', text: '¬´–Ø –Ω–µ –≤–∏–¥–µ–ª–∞ –ê—Ä—Ç—ë–º–∞ –ø–æ—Å–ª–µ –≤—Ç–æ—Ä–æ–≥–æ –∞–∫—Ç–∞. –û–Ω —É—à—ë–ª –¥–æ–º–æ–π.¬ª' },
    { x: 400, name: '–ë–æ—Ä–∏—Å', text: '¬´–Ø –≤–µ—Å—å –≤–µ—á–µ—Ä –≤ –∫–∞–±–∏–Ω–µ—Ç–µ. –ù–∏—á–µ–≥–æ –Ω–µ —Å–ª—ã—à–∞–ª.¬ª' },
    { x: 600, name: '–°—Ç–µ–ø–∞–Ω', text: '¬´–Ø –º—ã–ª –ø–æ–ª –∑–∞ –∫—É–ª–∏—Å–∞–º–∏. –°–ª—ã—à–∞–ª –∫—Ä–∏–∫‚Ä¶ –Ω–æ –ø–æ–¥—É–º–∞–ª ‚Äî —Ä–µ–ø–µ—Ç–∏—Ü–∏—è.¬ª' }
  ];

  chars.forEach(char => {
    let btn = this.add.text(char.x, 550, char.name, {
      fontSize: '20px',
      fill: '#ffcc00',
      backgroundColor: '#000000aa',
      padding: { x: 12, y: 8 }
    })
    .setOrigin(0.5)
    .setInteractive({ cursor: 'pointer' })
    .on('pointerdown', () => {
      console.log('–ö–ª–∏–∫ –ø–æ –ø–µ—Ä—Å–æ–Ω–∞–∂—É:', char.name);
      showText(this, `${char.name}: ${char.text}`);
    });
  });

  // –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
  this.add.text(400, 30, '–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –æ–±—ä–µ–∫—Ç–∞–º –∏–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º', {
    fontSize: '22px',
    fill: '#ffffff'
  }).setOrigin(0.5);
}

function showText(scene, text) {
  // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –¥–∏–∞–ª–æ–≥
  if (activeDialog) {
    activeDialog.destroy();
  }

  // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π
  activeDialog = scene.add.text(400, 120, text, {
    fontSize: '22px',
    fill: '#ffffff',
    backgroundColor: '#000000cc',
    padding: { x: 16, y: 12 },
    wordWrap: { width: 650 },
    align: 'center'
  }).setOrigin(0.5);

  // –í–∞—Ä–∏–∞–Ω—Ç 1: –∑–∞–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
  scene.time.delayedCall(5000, () => {
    if (activeDialog) {
      activeDialog.destroy();
      activeDialog = null;
    }
  });

  // –í–∞—Ä–∏–∞–Ω—Ç 2: –∑–∞–∫—Ä—ã—Ç—å –ø–æ –∫–ª–∏–∫—É –ù–ê –°–ê–ú–û–ú –î–ò–ê–õ–û–ì–ï
  activeDialog.setInteractive({ cursor: 'pointer' });
  activeDialog.on('pointerdown', () => {
    if (activeDialog) {
      activeDialog.destroy();
      activeDialog = null;
    }
  });
}
</script>

</body>

</html>



















