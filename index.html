<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>–¢–∞–π–Ω–∞ —Å—Ç–∞—Ä–æ–≥–æ —Ç–µ–∞—Ç—Ä–∞</title>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
  <style>body { margin: 0; }</style>
</head>
<body>

<script>
const config = {
  type: Phaser.AUTO,
  width: 800,
  height: 600,
  backgroundColor: '#000',
  scene: {
    preload: preload,
    create: create,
    update: update
  }
};

let cluesFound = 0;
let activeDialog = null;

const game = new Phaser.Game(config);

function preload() {
  // –ó–∞–≥—Ä—É–∑–∏ —Å–≤–æ–π —Ñ–æ–Ω –∑–¥–µ—Å—å. –ü—Ä–∏–º–µ—Ä:
  this.load.image('background', 'theater.jpg');
  
  // –ï—Å–ª–∏ –Ω–µ—Ç —Ñ–∞–π–ª–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å—Å—ã–ª–∫—É (–∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–≤–æ—é –ø–æ–∑–∂–µ):
  //this.load.image('background', 'https://s.iimg.su/s/29/gnH7IEJxO2DeUfgOkqOhhIPuhYbarzsFLKu2z0VV.jpg');
}

function create() {
  // –§–æ–Ω
  this.add.image(400, 300, 'background').setDisplaySize(800, 600);

  // –£–ª–∏–∫–∏: [x, y, radius, —Ç–µ–∫—Å—Ç]
  const clues = [
    [400, 400, 30, 'üé≠ –ú–∞—Å–∫–∞: –°–ª–µ–¥—ã –ø–æ–º–∞–¥—ã. –ù–æ –ê—Ä—Ç—ë–º ‚Äî –º—É–∂—á–∏–Ω–∞.'],
    [600, 450, 25, '‚òï –ß–∞—à–∫–∞: –¢—ë–ø–ª–∞—è. –ü—Ä–æ–ª–∏—Ç–∞ –Ω–µ–¥–∞–≤–Ω–æ.'],
    [200, 450, 25, 'üìú –ó–∞–ø–∏—Å–∫–∞: –ë—É–º–∞–≥–∞ —Å –≥–µ—Ä–±–æ–º —Ç–µ–∞—Ç—Ä–∞... —Ç–æ–ª—å–∫–æ —É —Ä–µ–∂–∏—Å—Å—ë—Ä–∞.'],
    [700, 300, 20, 'üé´ –ë–∏–ª–µ—Ç: –ú–µ—Å—Ç–æ 13. –°–ø–µ–∫—Ç–∞–∫–ª—å –æ—Ç–º–µ–Ω–∏–ª–∏...'],
    [100, 300, 20, 'üîë –ö–ª—é—á: –û—Ç –ø–æ–¥–≤–∞–ª–∞. –ù–µ–¥–∞–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω.']
  ];

  // –°–æ–∑–¥–∞—ë–º –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ –∑–æ–Ω—ã
  clues.forEach(clue => {
    let zone = this.add.zone(clue[0], clue[1], clue[2]*2, clue[2]*2).setInteractive({ cursor: 'pointer' });
    zone.on('pointerdown', () => {
      if (!activeDialog) {
        showText(this, clue[3]);
      }
    });
  });

  // –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π (–≤–Ω–∏–∑—É)
  const chars = [
    { x: 200, name: '–õ—é–¥–º–∏–ª–∞', text: '¬´–Ø –Ω–µ –≤–∏–¥–µ–ª–∞ –ê—Ä—Ç—ë–º–∞ –ø–æ—Å–ª–µ –≤—Ç–æ—Ä–æ–≥–æ –∞–∫—Ç–∞. –û–Ω —É—à—ë–ª –¥–æ–º–æ–π.¬ª' },
    { x: 400, name: '–ë–æ—Ä–∏—Å', text: '¬´–Ø –≤–µ—Å—å –≤–µ—á–µ—Ä –≤ –∫–∞–±–∏–Ω–µ—Ç–µ. –ù–∏—á–µ–≥–æ –Ω–µ —Å–ª—ã—à–∞–ª.¬ª' },
    { x: 600, name: '–°—Ç–µ–ø–∞–Ω', text: '¬´–Ø –º—ã–ª –ø–æ–ª –∑–∞ –∫—É–ª–∏—Å–∞–º–∏. –°–ª—ã—à–∞–ª –∫—Ä–∏–∫‚Ä¶ –Ω–æ –ø–æ–¥—É–º–∞–ª ‚Äî —Ä–µ–ø–µ—Ç–∏—Ü–∏—è.¬ª' }
  ];

  chars.forEach(char => {
    let btn = this.add.text(char.x, 550, char.name, {
      fontSize: '20px',
      fill: '#fff',
      backgroundColor: '#333',
      padding: { x: 10, y: 5 }
    }).setInteractive({ cursor: 'pointer' });
    
    btn.on('pointerdown', () => {
      if (!activeDialog) {
        showText(this, `${char.name}: ${char.text}`);
      }
    });
  });

  // –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
  this.add.text(16, 16, '–ö–ª–∏–∫–∞–π—Ç–µ –ø–æ –æ–±—ä–µ–∫—Ç–∞–º –∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º', { fill: '#fff' });
}

function showText(scene, text) {
  if (activeDialog) return;
  
  activeDialog = scene.add.text(400, 100, text, {
    fontSize: '22px',
    fill: '#fff',
    backgroundColor: '#000000cc',
    padding: { x: 15, y: 10 },
    wordWrap: { width: 600 }
  }).setOrigin(0.5);
  
  // –ó–∞–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 5 —Å–µ–∫ –∏–ª–∏ –ø–æ –∫–ª–∏–∫—É
  scene.input.once('pointerdown', () => {
    activeDialog.destroy();
    activeDialog = null;
  });
  
  scene.time.delayedCall(5000, () => {
    if (activeDialog) {
      activeDialog.destroy();
      activeDialog = null;
    }
  });
}

function update() {}
</script>

</body>
</html>